2025-12-11 02:46:25,939 - __main__ - ERROR - HANNAH_FIREBASE_JSON not set and firebase.json not found!
2025-12-11 02:47:05,033 - __main__ - INFO - Using local firebase.json for credentials.
2025-12-11 02:47:05,060 - __main__ - INFO - Connected to Firebase RTDB
2025-12-11 02:47:05,572 - __main__ - INFO - Water model & scaler loaded.
2025-12-11 02:47:05,702 - __main__ - INFO - YOLO models loaded.
2025-12-11 02:47:05,703 - __main__ - INFO - Starting ML prediction run...
2025-12-11 02:47:05,935 - __main__ - ERROR - Error during ML prediction run: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
Traceback (most recent call last):
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 158, in <module>
    run_predictions()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 102, in run_predictions
    sensor_key, sensor_data = get_latest_entry("/water_quality")
                              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 90, in get_latest_entry
    snapshot = ref.get()
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 220, in get
    return self._client.body('get', self._add_suffix(), params=params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 148, in body
    resp = self.request(method, url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 928, in request
    return super().request(method, url, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 135, in request
    resp = self._session.request(method, self.base_url + url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\transport\requests.py", line 530, in request
    self.credentials.before_request(auth_request, method, url, request_headers)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 228, in before_request
    self._blocking_refresh(request)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
    ~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 365, in refresh
    self._refresh_token(request)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\service_account.py", line 457, in _refresh_token
    access_token, expiry, _ = _client.jwt_grant(
                              ~~~~~~~~~~~~~~~~~^
        request, self._token_uri, assertion
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 299, in jwt_grant
    response_data = _token_endpoint_request(
        request,
    ...<5 lines>...
        },
    )
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 270, in _token_endpoint_request
    _handle_error_response(response_data, retryable_error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 69, in _handle_error_response
    raise exceptions.RefreshError(
        error_details, response_data, retryable=retryable_error
    )
google.auth.exceptions.RefreshError: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
2025-12-11 02:51:56,868 - __main__ - INFO - Using local firebase.json for credentials.
2025-12-11 02:51:56,895 - __main__ - INFO - Connected to Firebase RTDB
2025-12-11 02:51:57,364 - __main__ - INFO - Water model & scaler loaded.
2025-12-11 02:51:57,483 - __main__ - INFO - YOLO models loaded.
2025-12-11 02:51:57,483 - __main__ - INFO - Starting ML prediction run...
2025-12-11 02:51:57,746 - __main__ - ERROR - Error during ML prediction run: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
Traceback (most recent call last):
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 158, in <module>
    run_predictions()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 102, in run_predictions
    sensor_key, sensor_data = get_latest_entry("/water_quality")
                              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 90, in get_latest_entry
    snapshot = ref.get()
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 220, in get
    return self._client.body('get', self._add_suffix(), params=params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 148, in body
    resp = self.request(method, url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 928, in request
    return super().request(method, url, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 135, in request
    resp = self._session.request(method, self.base_url + url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\transport\requests.py", line 530, in request
    self.credentials.before_request(auth_request, method, url, request_headers)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 228, in before_request
    self._blocking_refresh(request)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
    ~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 365, in refresh
    self._refresh_token(request)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\service_account.py", line 457, in _refresh_token
    access_token, expiry, _ = _client.jwt_grant(
                              ~~~~~~~~~~~~~~~~~^
        request, self._token_uri, assertion
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 299, in jwt_grant
    response_data = _token_endpoint_request(
        request,
    ...<5 lines>...
        },
    )
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 270, in _token_endpoint_request
    _handle_error_response(response_data, retryable_error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 69, in _handle_error_response
    raise exceptions.RefreshError(
        error_details, response_data, retryable=retryable_error
    )
google.auth.exceptions.RefreshError: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
2025-12-11 02:52:53,800 - __main__ - INFO - Using local firebase.json for credentials.
2025-12-11 02:52:53,826 - __main__ - INFO - Connected to Firebase RTDB
2025-12-11 02:52:54,285 - __main__ - INFO - Water model & scaler loaded.
2025-12-11 02:52:54,407 - __main__ - INFO - YOLO models loaded.
2025-12-11 02:52:54,407 - __main__ - INFO - Starting ML prediction run...
2025-12-11 02:52:54,653 - __main__ - ERROR - Error during ML prediction run: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
Traceback (most recent call last):
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 158, in <module>
    run_predictions()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 102, in run_predictions
    sensor_key, sensor_data = get_latest_entry("/water_quality")
                              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 90, in get_latest_entry
    snapshot = ref.get()
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 220, in get
    return self._client.body('get', self._add_suffix(), params=params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 148, in body
    resp = self.request(method, url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 928, in request
    return super().request(method, url, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 135, in request
    resp = self._session.request(method, self.base_url + url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\transport\requests.py", line 530, in request
    self.credentials.before_request(auth_request, method, url, request_headers)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 228, in before_request
    self._blocking_refresh(request)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
    ~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 365, in refresh
    self._refresh_token(request)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\service_account.py", line 457, in _refresh_token
    access_token, expiry, _ = _client.jwt_grant(
                              ~~~~~~~~~~~~~~~~~^
        request, self._token_uri, assertion
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 299, in jwt_grant
    response_data = _token_endpoint_request(
        request,
    ...<5 lines>...
        },
    )
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 270, in _token_endpoint_request
    _handle_error_response(response_data, retryable_error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 69, in _handle_error_response
    raise exceptions.RefreshError(
        error_details, response_data, retryable=retryable_error
    )
google.auth.exceptions.RefreshError: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
2025-12-11 02:53:30,315 - __main__ - INFO - Using local firebase.json for credentials.
2025-12-11 02:53:30,342 - __main__ - INFO - Connected to Firebase RTDB
2025-12-11 02:53:32,704 - __main__ - INFO - Water model & scaler loaded.
2025-12-11 02:53:32,841 - __main__ - INFO - YOLO models loaded.
2025-12-11 02:53:32,841 - __main__ - INFO - Starting ML prediction run...
2025-12-11 02:53:33,070 - __main__ - ERROR - Error during ML prediction run: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
Traceback (most recent call last):
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 158, in <module>
    run_predictions()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 102, in run_predictions
    sensor_key, sensor_data = get_latest_entry("/water_quality")
                              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\MLPredictions.py", line 90, in get_latest_entry
    snapshot = ref.get()
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 220, in get
    return self._client.body('get', self._add_suffix(), params=params)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 148, in body
    resp = self.request(method, url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\db.py", line 928, in request
    return super().request(method, url, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\firebase_admin\_http_client.py", line 135, in request
    resp = self._session.request(method, self.base_url + url, **kwargs)
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\transport\requests.py", line 530, in request
    self.credentials.before_request(auth_request, method, url, request_headers)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 228, in before_request
    self._blocking_refresh(request)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 191, in _blocking_refresh
    self.refresh(request)
    ~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\auth\credentials.py", line 365, in refresh
    self._refresh_token(request)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\service_account.py", line 457, in _refresh_token
    access_token, expiry, _ = _client.jwt_grant(
                              ~~~~~~~~~~~~~~~~~^
        request, self._token_uri, assertion
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 299, in jwt_grant
    response_data = _token_endpoint_request(
        request,
    ...<5 lines>...
        },
    )
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 270, in _token_endpoint_request
    _handle_error_response(response_data, retryable_error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Predator\OneDrive\Desktop\UCSI\Degree\Y4\Sem1\IDP\IDP_Application\Server\hannah\.venv\Lib\site-packages\google\oauth2\_client.py", line 69, in _handle_error_response
    raise exceptions.RefreshError(
        error_details, response_data, retryable=retryable_error
    )
google.auth.exceptions.RefreshError: ('invalid_grant: Invalid JWT Signature.', {'error': 'invalid_grant', 'error_description': 'Invalid JWT Signature.'})
